<div class="alert-box processing" ng-if="isProcessing">
  One or more Feeds are processing. Please <a href="{{$location.absUrl()}}/">Refresh</a> this page for an update. <small>(Page will automatically reload after a minute.)</small>
</div>

<h2>Active Feeds</h2>

<span ng-if="!feeds" class="is-loading"></span>
<table id="feedsTable" ng-table="feedTableParams" template-pagination="feedsPagination" class="associations">
  <tr id="feedIndex{{$index}}" ng-repeat="feed in $data">
    <td id="date{{$index}}" data-title="'Date'" sortable="'date'" ><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}">{{feed.date}}</a>
    </td>
    <td id="state{{$index}}" data-title="'State'" sortable="'state'"><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}">{{feed.state}}</a>
    </td>
    <td id="type{{$index}}" data-title="'Type'" sortable="'type'"><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}">{{feed.type}}</a>
    </td>
    <td id="status{{$index}}" data-title="'Status'" sortable="'status'"><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}"><span class="is-loading-small" ng-show="!feed.complete && !feed.failed"></span><i ng-if="feed.failed" class="fi-prohibited"></i> {{feed.status}} {{feed.processingTime}}</a>
    </td>
    <td data-title="'Due'" sortable="'due'"><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}">{{feed.due_in}}</a></td>
  </tr>
  <tr ng-if="feeds.length === 0">
    <td colspan="6">No Feeds Found</td>
  </tr>
</table>

<script type="text/ng-template" id="feedsPagination">
  <ul class="pagination ng-cloak">
    <li ng-repeat="page in pages"
        ng-class="{'ng-hide': page.type == 'prev' || page.type == 'next'}">
      <a id="feedsPage{{$index}}" ng-class="{'is-active': page.number == tableParams.page()}"
         ng-click="feedTableParams.page(page.number)" href="">{{page.number}}</a>
    </li>
  </ul>
</script>