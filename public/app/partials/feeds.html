
<div class="alert-box processing" ng-if="isProcessing">
  One or more Feeds are processing. Please <a href="/">Refresh</a> this page for an update. <small>(Page will automatically refresh after a minute.)</small>
</div>

<div class="data-module data-module-full">
<h2>Active Feeds</h2>

<span ng-if="!feeds" class="is-loading"></span>
<table id="feedsTable" ng-table="feedTableParams" template-pagination="feedsPagination" class="associations">
  <tr id="feedIndex{{$index}}" ng-repeat="feed in $data">
    <td id="date{{$index}}" data-title="'Date'" sortable="'date'" ><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}" data-title-text="Date"><span class="td-text">{{feed.date}}</span></a>
    </td>
    <td id="state{{$index}}" data-title="'State'" sortable="'state'"><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}" data-title-text="State"><span class="td-text">{{feed.state}}</span></a>
    </td>
    <td id="type{{$index}}" data-title="'Type'" sortable="'type'"><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}" data-title-text="Type"><span class="td-text">{{feed.type}}</span></a>
    </td>
    <td id="status{{$index}}" data-title="'Status'" sortable="'status'"><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}" data-title-text="Status"><span class="is-loading-small" ng-show="!feed.complete && !feed.failed"></span><i ng-if="feed.failed" class="fi-prohibited"></i> <span class="td-text">{{feed.status}} <small>{{feed.processingTime}}</small></span></a>
    </td>
    <td data-title="'Due'" sortable="'due'"><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}" data-title-text="Due"><span class="td-text">{{feed.due_in}}</span></a></td>
    <td data-title="'Loaded On'" sortable="'date_loaded'"><a ng-class="{'disabled-row': !feed.complete && !feed.failed, 'disabled-row-failed': !feed.complete && feed.failed}" href="{{feed.self}}" data-title-text="Loaded On"><span class="td-text">{{feed.date_loaded_formatted}}</span></a></td>
  </tr>
  <tr ng-if="feeds.length === 0">
    <td colspan="6"><p style="padding: 1em;">No Feeds Found</p></td>
  </tr>
</table>

<script type="text/ng-template" id="feedsPagination">
  <ul class="pagination ng-cloak">
    <li ng-repeat="page in pages"
        ng-class="{'ng-hide': page.type == 'prev' || page.type == 'next'}">
      <a id="feedsPage{{$index}}" ng-class="{'is-active': page.number == tableParams.page()}"
         ng-click="feedTableParams.page(page.number)" href="">{{page.number}}</a>
    </li>
  </ul>
</script>
</div>

<small>Plese Note: This is simply a temporary form to facilitate in starting the feed processing.</small>
<div style="border: 1px solid #cecece; padding: 5px; width: 500px">
  <small>
    1) Place the feed file under the app's <b>/upload</b> folder<br>
    2) Enter the file name below and hit enter<br>
    <form target="_blank" action="/services/feeds" method="post"><input style="width: 350px;" type="text" name="filename"></form>
    3) Close the corresponding tab that opens<br>
    4) Refresh this page to see the feed process<br>
  </small>
</div>